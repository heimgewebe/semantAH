ai_context_version: 1.0

project:
  name: chronik
  summary: Event ingest, persistence, and audit store for Heimgewebe services.
  role: event_ingest_persistence
  primary_language: rust
  visibility: internal

dependencies:
  internal:
    - name: contracts
      relationship: uses
      interface:
        - json_schema
        - proto
    - name: hauski-audio
      relationship: uses
      interface:
        - audio_events
    - name: mitschreiber
      relationship: uses
      interface:
        - optional_event_feed
    - name: aussensensor
      relationship: uses
      interface:
        - http_ingest_aussen
  external:
    - name: tokio
      version: "1.x"
    - name: serde
    - name: serde_json
    - name: tracing

architecture:
  entrypoints:
    - src/main.rs
  key_paths:
    - path: src/ingest/
      purpose: HTTP ingest + validation
    - path: src/pipeline/
      purpose: event processing
  data_flow:
    input: HTTP POST /ingest/*
    processing: JSON Schema validation + pipelines
    output: storage + metrics

conventions:
  branching: "main, feature/*"
  commit_prefix: "chronik"
  ci_platform: github_actions

documentation:
  adr: docs/adr/
  runbook: docs/runbook.md

ai_guidance:
  do:
    - pull validation rules from contracts and reject non-conforming events
    - prefer structured logs via tracing; avoid println! in hot paths
  dont:
    - accept payloads without schema validation
